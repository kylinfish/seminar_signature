
{% extends 'base.html' %} 
{% block content %}
{% load staticfiles %}
  <style type="text/css">
   .profile {
    min-height: 355px;
    display: inline-block;
    font-size:30px;
    }
    .input-group {
    margin: 20px auto;
    width: 100%;
  }
  .img-responsive {
     height:45%;
     width:45%;
  }

  input.btn.btn-lg,
  input.btn.btn-lg:focus {
      outline: none;
      width: 60%;
      height: 60px;
      border-top-right-radius: 0;
      border-bottom-right-radius: 0;
  }
  .input-group .btn {
      width: 25%;
      height: 60px;
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
  }
  .icon{
    width:70px;
    height:70px;
    margin-left: -15px;
    margin-right: 15px;
  }
  </style>
  <link rel="stylesheet" type="text/css" href="{% static 'css/clock.css'%}">  
    <div id="clock" class="light">
      <div class="display">
        <div class="ampm"></div>
        <div class="digits"></div>
      </div>
    </div>
    <div class="container col-md-offset-2">
    <h1>更新學生卡號</h1>
      <div class="col-md-8">
        <div>
        <form accept-charset="UTF-8" >
          <div class="input-group">
            <img class="icon" src="{% static 'icon/p7.png' %}">     
             <input class="btn btn-lg" id="number" type="text" placeholder="card number" required autofocus>
             <button class="btn btn-info btn-lg" type="submit">Signature</button>
             <select id = "user" class="form-control col-md-4" >
              {% for s in student%}
              <option value="{{s.pk}}">{{s.c_g}} | {{s.s_id}} | {{ s.name }}</option>
              {% endfor %}
            </select>
             
          </div>
          <h4>order by Student-ID</h4>
          </form>
        </div>
      </div>
      <div class="row">
        <div class="col-md-8 profile">
          <div class="alert alert-success" id="success-message" style="display: none;"></div>
          <div class="alert alert-danger" id="error-message" style="display: none;"></div>
        </div>

    </div> <!-- /container -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/moment.js/2.0.0/moment.min.js"></script>
<script type="text/javascript" src="{% static 'js/clock.js'%}"></script>
<script type="text/javascript">
var url = window.location.toString();
var unit="10";
$(function() {
    $('form').on('submit', function (e) {
    e.preventDefault();
    sign();
  });
});
function showSuccessMsg(text){
  $("#success-message").text(text);
  $('#success-message').fadeIn( "slow", function(){});
  $('#success-message').delay(1500).fadeOut( "slow", function() {
  });
}
function showErrorMsg(text){
  $("#error-message").text(text);
  $('#error-message').fadeIn( "slow", function(){});
  $('#error-message').delay(1500).fadeOut( "slow", function() {
  });
}

function sign(btn,field){
  $.ajax({
    url: "/commit_fb" , 
    type: 'POST', 
    data: {
      'number': $("#number").val(),
      'user': $("#user").val(),
    },
    success: function(msg) {
      $("#number").val("");
      if (msg == 'success'){
       showSuccessMsg("修改成功!!");
      }else{
        showErrorMsg(msg);  
        resetField();
      }
    },
    error: function(msg) {
      $("#number").val("");
      showErrorMsg(msg);
      resetField();
    }
  });
}

function resetField(){
  $("#profile_class").html("");
  $("#timestamp").html("");
  $("#profile_pic").attr("src","");
  $("#profile_user").html("");
  $("#profile_s_id").html("");
  $("#state").html("");
}

</script>
{% endblock %}
